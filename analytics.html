<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Advanced Pomodoro Tool</title><style>body{font-family:Arial,sans-serif;background:#f3f4f7;margin:0;padding:0;display:flex;flex-direction:column;align-items:center}.container{width:80%;max-width:1200px;background:#fff;padding:20px;margin-top:30px;border-radius:10px;box-shadow:0 4px 10px rgba(0,0,0,.1)}h1{text-align:center;color:#333}#avatar-modal{position:fixed;top:10px;left:10px;bottom:10px;right:10px;width:100%;height:100%;color:#fff;background:rgba(0,0,0,.8);display:flex;justify-content:center;align-items:center}.modal-content{position:relative;top:10px;left:10px;bottom:10px;right:10px;width:50%;height:50%;background:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;background:#00000000;padding:20px;border-radius:10px;box-shadow:0 4px 10px rgba(0,0,0,.1)}.modal-content h2{margin-top:0;color:#333}.modal-content button{margin:10px;padding:10px 20px;border:none;border-radius:5px;background:linear-gradient(135deg,#000,#6a0dad);color:#fff;font-size:1rem;cursor:pointer;transition:background .3s,transform .3s}.modal-content button:hover{background:linear-gradient(135deg,red,#6a0dad);transform:scale(1.1)}.avatar-img{width:300px;height:300px;border-radius:50%;border:2px solid #ff007f;object-fit:cover;margin-bottom:10px}.selected-avatar{margin-top:20px;width:auto;display:absolute;justify-content:center;background:linear-gradient(180deg,#620069,#06004d);padding:15px;border-radius:50px}.selected-avatar img{width:200px;height:200px;border-radius:50%;border:4px solid #ff69b4;object-fit:cover}.selected-avatar:hover{background:linear-gradient(180deg,#06004d,#620069);transform:scale(1.05)}.admin-dashboard,.categories{margin-top:20px}.categories{display:flex;justify-content:space-between;margin-bottom:20px}.category{width:18%;text-align:center;padding:10px;border-radius:8px;background:#f0f0f0;box-shadow:0 3px 6px rgba(0,0,0,.1)}.category h3{margin:0;color:#555}.buttons{margin-top:10px}.buttons button{width:30px;height:30px;border-radius:50%;border:2px solid #0ff;background:#007bff;color:#fff;font-size:18px;cursor:pointer;margin:2px}.buttons button.remove{background:#dc3545;border-color:#dc3545;border:2px solid #000}.admin-dashboard{margin-top:30px}.admin-dashboard table{width:100%;border-collapse:collapse;margin-bottom:20px}.admin-dashboard th,td{padding:8px;text-align:center;border:1px solid #ddd}.admin-dashboard th{background:linear-gradient(135deg,#000236,#560061);color:#fff}.admin-dashboard .no-data{text-align:center;font-style:italic;color:#888}.table-title{background:linear-gradient(135deg,#000236,#ff69b4);color:#fff;padding:10px;font-size:18px;text-align:center;border-radius:8px;margin-bottom:10px}.save-controls{display:flex;justify-content:center;margin-top:20px}.save-controls button{width:90px;height:90px;border-radius:50%;border:10px solid indigo;background:#ff69b4;color:#000;font-size:20px;margin:5px;cursor:pointer;transition:background .3s,border-color .3s}.save-controls button:hover{color:#fff;background:linear-gradient(135deg,#000236,#560061);border-color:#00bfff}.ranking{margin-top:20px;width:100%;text-align:center}.ranking h2{background:linear-gradient(135deg,#000236,#ff69b4);color:#fff;padding:10px;border-radius:8px}#ranking-list{margin-top:10px}.ranking-item{padding:10px;border-bottom:1px solid #ddd}.progress{margin-top:20px;width:100%;text-align:center}#progress-bar-container{width:100%;background:#f0f0f0;border-radius:5px;overflow:hidden}#progress-bar{height:20px;width:0;background:linear-gradient(135deg,#000236,#ff69b4)}#progress-info{margin-top:10px}.comparison{margin-top:20px;width:100%}.comparison table{width:100%;border-collapse:collapse}.comparison td,.comparison th{padding:8px;border:1px solid #ddd;text-align:center}.comparison th{background:linear-gradient(135deg,#000236,#560061);color:#fff}</style></head><body><div class="container"><h1>Advanced Pomodoro Tool For</h1><div id="selected-avatar" class="selected-avatar" style="display:none"><img id="selected-avatar-img" src="" alt="Selected User"></div><div id="avatar-modal" style="display:none"><div class="modal-content"><h2>Select User</h2><button onclick='selectUser("saikat")' class="avatar-button"><img src="https://lh3.googleusercontent.com/a/ACg8ocJTg6fs8P1tVPRj2T8BFE7ZShmRg2qUQLH8SuydS1Pr92rfBMY_=s288-c-no" alt="Saikat" class="avatar-img"><div>Saikat</div></button><button onclick='selectUser("sougata")' class="avatar-button"><img src="https://lh3.googleusercontent.com/a/ACg8ocK5C7jp5ss8PH1Uc7jeDiRQoN6KO1AhULG-ZGatkmOqPplNqnSNNA=s288-c-no" alt="Sougata" class="avatar-img"><div>Sougata</div></button><button onclick="closeModal()">Close</button></div></div><div class="categories"><div class="category"><h3>Korean</h3><div class="count" id="korean-count">0</div><div class="buttons"><button onclick='modifyCategory("korean",1)'>+</button><button class="remove" onclick='modifyCategory("korean",-1)'>-</button></div></div><div class="category"><h3>Hollywood</h3><div class="count" id="hollywood-count">0</div><div class="buttons"><button onclick='modifyCategory("hollywood",1)'>+</button><button class="remove" onclick='modifyCategory("hollywood",-1)'>-</button></div></div><div class="category"><h3>Bollywood</h3><div class="count" id="bollywood-count">0</div><div class="buttons"><button onclick='modifyCategory("bollywood",1)'>+</button><button class="remove" onclick='modifyCategory("bollywood",-1)'>-</button></div></div><div class="category"><h3>Anime</h3><div class="count" id="anime-count">0</div><div class="buttons"><button onclick='modifyCategory("anime",1)'>+</button><button class="remove" onclick='modifyCategory("anime",-1)'>-</button></div></div><div class="category"><h3>South-Indian</h3><div class="count" id="southIndian-count">0</div><div class="buttons"><button onclick='modifyCategory("southIndian",1)'>+</button><button class="remove" onclick='modifyCategory("southIndian",-1)'>-</button></div></div></div><div class="save-controls"><button id="save-button" onclick='saveToLocal(),resetCategories(),calculateRankings(),updateProgressBar(),populateComparisonTable(),showNotification("Your input has been saved, Good Luck.")'>Save</button></div><div class="admin-dashboard"><div class="ranking"><h2>Ranking</h2><div id="ranking-list"></div></div><div class="progress"><h2>Daily Quota</h2><div id="progress-bar-container"><div id="progress-bar"></div></div><div id="progress-info"></div></div><div class="comparison"><h2>User Comparison</h2><table id="user-comparison-table"><thead><tr><th>User</th><th>Korean</th><th>Hollywood</th><th>Bollywood</th><th>Anime</th><th>South-Indian</th></tr></thead><tbody></tbody></table></div><div class="table-title">Today's Achievement</div><table><thead><tr><th>Total Posts</th><th>Details</th></tr></thead><tbody id="daily-achievements"><tr><td id="daily-total-posts">0</td><td id="daily-details" class="no-data">No data</td></tr></tbody></table><div class="table-title">Daily Achievement</div><table><thead><tr><th>Day</th><th>Total Posts</th><th>How Many / Category</th></tr></thead><tbody id="daily-achievement-table"></tbody></table><div class="table-title">How Many Posts Did the other one Publish?</div><table><thead><tr><th>User</th><th>Total Posts</th><th>How Many / Category</th></tr></thead><tbody id="other-user-achievements"></tbody></table><div class="table-title">Weekly Achievement</div><table><thead><tr><th>Week</th><th>Total Posts</th><th>How Many / Category</th></tr></thead><tbody id="weekly-achievements"></tbody></table><div class="table-title">Monthly Achievement</div><table><thead><tr><th>Month</th><th>Total Posts</th><th>How Many / Category</th></tr></thead><tbody id="monthly-achievements"></tbody></table></div></div><script>const users = {
        saikat: {
          korean: 0,
          hollywood: 0,
          bollywood: 0,
          anime: 0,
          southIndian: 0
        },
        sougata: {
          korean: 0,
          hollywood: 0,
          bollywood: 0,
          anime: 0,
          southIndian: 0
        }
      };
      let currentUser = 'saikat';
      // Function to open the avatar selection modal
      const openModal = () => {
        document.getElementById('avatar-modal').style.display = 'flex';
      };
      // Function to close the avatar selection modal
      const closeModal = () => {
        document.getElementById('avatar-modal').style.display = 'none';
      };
      // Update initialization to open modal on load
      // Update selectUser function to include saving user data
      const selectUser = (user) => {
        currentUser = user;
        updateCounts();
        populateAchievements();
        populateDailyAchievementTable();
        populateOtherUserData();
        closeModal();
        updateProgressBar();// Close the modal after selection
        // Update avatar display
        const avatarUrl = user === 'saikat' ? 'https://lh3.googleusercontent.com/a/ACg8ocJTg6fs8P1tVPRj2T8BFE7ZShmRg2qUQLH8SuydS1Pr92rfBMY_=s288-c-no' : 'https://lh3.googleusercontent.com/a/ACg8ocK5C7jp5ss8PH1Uc7jeDiRQoN6KO1AhULG-ZGatkmOqPplNqnSNNA=s288-c-no';
        document.getElementById('selected-avatar-img').src = avatarUrl;
        document.getElementById('selected-avatar').style.display = 'flex';
        // Update button styles
        document.querySelectorAll('.avatar-button').forEach(button => {
          button.classList.remove('active');
        });
        document.querySelector(`[onclick="selectUser('${user}')"]`).classList.add('active');
      };
      const modifyCategory = (category, delta) => {
        if (users[currentUser][category] + delta >= 0) {
          users[currentUser][category] += delta;
          updateCounts();
        }
      };
      const updateCounts = () => {
        Object.keys(users[currentUser]).forEach(cat => {
          document.getElementById(`${cat}-count`).textContent = users[currentUser][cat];
        });
      };
      const saveToLocal = () => {
        const dailyAchievements = JSON.parse(localStorage.getItem('dailyAchievements')) || {};
        const weeklyAchievements = JSON.parse(localStorage.getItem('weeklyAchievements')) || {};
        const monthlyAchievements = JSON.parse(localStorage.getItem('monthlyAchievements')) || {};
        const today = new Date().toISOString().split('T')[0];
        const weekOfMonth = getWeekOfMonth(new Date());
        const monthName = new Date().toLocaleString('default', {
          month: 'long'
        });
        const newDailyData = {
          ...users[currentUser]
        };
        const newWeeklyData = {
          ...users[currentUser]
        };
        const newMonthlyData = {
          ...users[currentUser]
        };
        dailyAchievements[currentUser] = dailyAchievements[currentUser] || {};
        dailyAchievements[currentUser][today] = mergeData(dailyAchievements[currentUser][today] || {}, newDailyData);
        localStorage.setItem('dailyAchievements', JSON.stringify(dailyAchievements));
        weeklyAchievements[currentUser] = weeklyAchievements[currentUser] || {};
        weeklyAchievements[currentUser][weekOfMonth] = mergeData(weeklyAchievements[currentUser][weekOfMonth] || {}, newWeeklyData);
        localStorage.setItem('weeklyAchievements', JSON.stringify(weeklyAchievements));
        monthlyAchievements[currentUser] = monthlyAchievements[currentUser] || {};
        monthlyAchievements[currentUser][monthName] = mergeData(monthlyAchievements[currentUser][monthName] || {}, newMonthlyData);
        localStorage.setItem('monthlyAchievements', JSON.stringify(monthlyAchievements));
        populateAchievements();
        populateDailyAchievementTable();
        updateCounts()
      };
      const mergeData = (previousData, newData) => {
        const mergedData = {
          ...previousData
        };
        Object.keys(newData).forEach(key => {
          if (key === 'workTime' || key === 'breakTime') {
            mergedData[key] = (mergedData[key] || 0) + newData[key];
          } else {
            mergedData[key] = (mergedData[key] || 0) + newData[key];
          }
        });
        return mergedData;
      };
      const populateAchievements = () => {
        const dailyAchievements = JSON.parse(localStorage.getItem('dailyAchievements')) || {};
        const weeklyAchievements = JSON.parse(localStorage.getItem('weeklyAchievements')) || {};
        const monthlyAchievements = JSON.parse(localStorage.getItem('monthlyAchievements')) || {};
        const today = new Date().toISOString().split('T')[0];
        const weekOfMonth = getWeekOfMonth(new Date());
        const monthName = new Date().toLocaleString('default', {
          month: 'long'
        });
        const dailyData = (dailyAchievements[currentUser] || {})[today] || {};
        const weeklyData = (weeklyAchievements[currentUser] || {})[weekOfMonth] || {};
        const monthlyData = (monthlyAchievements[currentUser] || {})[monthName] || {};
        const dailyTotalPosts = calculateTotalPosts(dailyData);
        const dailyDetails = formatDetails(dailyData);
        document.getElementById('daily-total-posts').textContent = dailyTotalPosts;
        document.getElementById('daily-details').innerHTML = dailyDetails || 'No data';
        populateWeeklyTable(weeklyAchievements[currentUser] || {});
        populateMonthlyTable(monthlyAchievements[currentUser] || {});
      };
      const populateDailyAchievementTable = () => {
        const dailyAchievements = JSON.parse(localStorage.getItem('dailyAchievements')) || {};
        const tableBody = document.getElementById('daily-achievement-table');
        tableBody.innerHTML = '';
        const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
        days.forEach((day, index) => {
          const date = new Date();
          date.setDate(date.getDate() - date.getDay() + index);
          const dayKey = date.toISOString().split('T')[0];
          const data = (dailyAchievements[currentUser] || {})[dayKey] || {};
          const totalPosts = calculateTotalPosts(data);
          const details = formatDetails(data);
          const row = `
								<tr>
									<td>${day}</td>
									<td>${totalPosts}</td>
									<td>${details || 'No data'}</td>
								</tr>`;
          tableBody.insertAdjacentHTML('beforeend', row);
        });
      };
      const populateWeeklyTable = (data) => {
        const tableBody = document.getElementById('weekly-achievements');
        tableBody.innerHTML = '';
        for (let week = 1; week <= 4; week++) {
          const weekData = data[week] || {};
          const totalPosts = calculateTotalPosts(weekData);
          const details = formatDetails(weekData);
          const row = `
								<tr>
									<td>Week ${week}</td>
									<td>${totalPosts}</td>
									<td>${details || 'No data'}</td>
								</tr>`;
          tableBody.insertAdjacentHTML('beforeend', row);
        }
      };
      const populateMonthlyTable = (data) => {
        const tableBody = document.getElementById('monthly-achievements');
        tableBody.innerHTML = '';
        Object.keys(data).forEach(month => {
          const monthData = data[month];
          const totalPosts = calculateTotalPosts(monthData);
          const details = formatDetails(monthData);
          const row = `
								<tr>
									<td>${month}</td>
									<td>${totalPosts}</td>
									<td>${details || 'No data'}</td>
								</tr>`;
          tableBody.insertAdjacentHTML('beforeend', row);
        });
      };
      const populateOtherUserData = () => {
        const otherUsers = Object.keys(users).filter(user => user !== currentUser);
        const tableBody = document.getElementById('other-user-achievements');
        tableBody.innerHTML = '';
        otherUsers.forEach(user => {
          const userData = JSON.parse(localStorage.getItem('dailyAchievements'))[user] || {};
          const accumulatedData = Object.values(userData).reduce((acc, dayData) => mergeData(acc, dayData), {});
          const totalPosts = calculateTotalPosts(accumulatedData);
          const details = formatDetails(accumulatedData);
          const row = `
								<tr>
									<td>${user}</td>
									<td>Total Posts: ${totalPosts}</td>
									<td>${details || 'No data'}</td>
								</tr>`;
          tableBody.insertAdjacentHTML('beforeend', row);
        });
      };
      const populateComparisonTable = () => {
    const tableBody = document.getElementById('user-comparison-table').querySelector('tbody');
    const userComparisons = Object.keys(users).map(user => {
        // Fetch data from localStorage
        const dailyAchievements = JSON.parse(localStorage.getItem('dailyAchievements')) || {};
        const data = dailyAchievements[user] || {};

        // Aggregate data for each category
        const aggregatedData = Object.keys(users[user]).reduce((acc, cat) => {
            acc[cat] = Object.values(data).reduce((sum, dayData) => (dayData[cat] || 0) + sum, 0);
            return acc;
        }, {});

        return { user, ...aggregatedData };
    });

    console.log('User Comparisons:', userComparisons); // Log user comparisons for debugging

    tableBody.innerHTML = userComparisons.map(userComp => `
        <tr>
            <td>${userComp.user}</td>
            <td>${userComp.korean}</td>
            <td>${userComp.hollywood}</td>
            <td>${userComp.bollywood}</td>
            <td>${userComp.anime}</td>
            <td>${userComp.southIndian}</td>
        </tr>
    `).join('');
};


      const calculateTotalPosts = (data) => {
        return Object.keys(users[currentUser]).reduce((total, category) => total + (data[category] || 0), 0);
      };
      const formatDetails = (data) => {
        const details = {};
        Object.keys(users[currentUser]).forEach(category => {
          if (data[category] !== undefined) {
            details[category] = data[category];
          }
        });
        return Object.entries(details).map(([category, count]) => `
								<p>${category.charAt(0).toUpperCase() + category.slice(1)}: ${count}</p>`).join('');
      };
      const getWeekOfMonth = (date) => {
        const firstDay = new Date(date.getFullYear(), date.getMonth(), 1);
        const dayOfWeek = firstDay.getDay();
        const offset = (date.getDate() + dayOfWeek - 1) / 7;
        return Math.ceil(offset);
      };
      const resetCategories = () => {
        Object.keys(users[currentUser]).forEach(cat => {
          users[currentUser][cat] = 0;
          document.getElementById(`${cat}-count`).textContent = 0;
        });
      };
      const requestNotificationPermission = () => {
        if (Notification.permission !== 'granted') {
          Notification.requestPermission().then(permission => {
            if (permission === 'granted') {
              console.log('Notification permission granted.');
            }
          });
        }
      };
      // Call this function when the page loads
      const showNotification = (title, body) => {
        if (Notification.permission === 'granted') {
          new Notification(title, {
            body
          });
        }
      };
      const calculateRankings = () => {
    const rankings = Object.keys(users).map(user => {
        const data = JSON.parse(localStorage.getItem('dailyAchievements'))[user] || {};
        const totalPosts = Object.values(data).reduce((acc, dayData) => mergeData(acc, dayData), {});
        return { user, totalPosts: calculateTotalPosts(totalPosts) };
    });

    rankings.sort((a, b) => b.totalPosts - a.totalPosts);

    const rankingList = document.getElementById('ranking-list');
    rankingList.innerHTML = rankings.map((rank, index) => `
        <div class="ranking-item">
            <strong>${index + 1}. ${rank.user}</strong>: ${rank.totalPosts} Posts
        </div>
    `).join('');
};

const updateProgressBar = () => {
    // Define a daily goal. Adjust as needed.
    const dailyGoal = 30;

    // Fetch daily achievements from localStorage
    const dailyAchievements = JSON.parse(localStorage.getItem('dailyAchievements')) || {};
    const userAchievements = dailyAchievements[currentUser] || {};

    // Aggregate posts for today (or adjust according to your requirement)
    const today = new Date().toISOString().split('T')[0];
    const todayData = userAchievements[today] || {};

    // Calculate total posts for the current user for today
    const totalPosts = calculateTotalPosts(todayData);

    // Calculate progress as a percentage
    const progressPercent = Math.min((totalPosts / dailyGoal) * 100, 100);

    // Update the progress bar width and text
    document.getElementById('progress-bar').style.width = `${progressPercent}%`;
    document.getElementById('progress-info').textContent = `Progress: ${totalPosts} / ${dailyGoal} Posts`;
};


      const populateLeaderboard = () => {
    const leaderboard = Object.keys(users).map(user => {
        const data = JSON.parse(localStorage.getItem('dailyAchievements'))[user] || {};
        const totalPosts = Object.values(data).reduce((acc, dayData) => mergeData(acc, dayData), {});
        return { user, totalPosts: calculateTotalPosts(totalPosts) };
    });

    leaderboard.sort((a, b) => b.totalPosts - a.totalPosts);

    const leaderboardList = document.getElementById('leaderboard-list');
    leaderboardList.innerHTML = leaderboard.map((rank, index) => `
        <div class="leaderboard-item">
            <strong>${index + 1}. ${rank.user}</strong>: ${rank.totalPosts} Posts
        </div>
    `).join('');
};

window.onload = () => {
    requestNotificationPermission();
    openModal();  // Show the modal for user selection
    calculateRankings();
    updateProgressBar();
    populateComparisonTable(); // Add this line
};</script></body></html>
